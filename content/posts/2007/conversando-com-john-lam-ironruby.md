---
title: "Conversando com John Lam (IronRuby)"
date: "2007-11-12T18:59:00.000Z"
tags: []
years: "2007"
---

<p></p>
<p><strong>English-version:</strong> <a href="/2007/11/12/chatting-with-john-lam-ironruby">here</a></p>
<div style="float: left; margin: 5px"><a href="http://www.iunknown.com/"><img src="http://s3.amazonaws.com/akitaonrails/assets/2007/11/12/n685772348_7884.jpg" srcset="http://s3.amazonaws.com/akitaonrails/assets/2007/11/12/n685772348_7884.jpg 2x" alt=""></a></div>
<p>Faz algum tempo desde minha última entrevista internacional, e estou de volta com ninguém menos que um dos responsáveis pelo Ruby rodar sobre a plataforma .<span class="caps">NET</span>. Isso mesmo, eu tenho coberto muito sobre JRuby e Rubinius mas não podemos negligenciar que uma das maiores plataformas do mercado está recebendo tratamento de Ruby também. Então convidei <a href="http://www.iunknown.com/">John Lam</a> , que gentilmente respondeu diversas perguntas sobre essa empreitada.</p>
<p>Lembrando que <a href="http://www.ironruby.net/">IronRuby</a> – nomeado depois de <a href="http://www.ironpython.com/">IronPython</a>, a primeira das principais linguagens dinâmicas construídas sobre o .<span class="caps">NET</span> – é um <a href="http://www.opensource.org/node/207">verdadeiro projeto open source</a>, e também tem um add-on de terceiros para Visual Studio.<span class="caps">NET</span>, de forma que programadores acostumados ao fluxo de trabalho do VS.<span class="caps">NET</span> poderão vir à bordo com uma curva menor de aprendizado.</p>
<p>A despeito de opiniões contrárias à Microsoft apenas com o objetivo de criticar, o fato persiste que Java e .<span class="caps">NET</span> representam os maiores mercados de desenvolvimento corporativo hoje. E também é um fato que a influência Ruby está se espalhando depressa. Poder rodar sobre ambos <span class="caps">JVM</span> e <span class="caps">CLR</span> representa permitir o Ruby em mercados de nicho que ele não alcançaria de outra maneira, e isso é um grande ganho. Eu falei um pouco sobre isso no meu artigo <a href="/2007/10/23/para-eu-ganhar-o-outro-precisa-perder">Para eu ganhar o outro precisa perder</a>. Existem pessoas muito inteligentes na Microsoft, John Lam sendo um deles.</p>
<p></p>
<p></p>
<p>Isso dito, vamos começar:</p>
<p><strong>AkitaOnRails:</strong> Primeiro de tudo, eu sempre pergunto a meus convidados sobre suas carreiras: qual foi seu caminho até aqui? Quero dizer, como você começou com computação, o que o trouxe até aqui?</p>
<p><strong>John Lam:</strong> Eu escrevi muito software antes de me formar no colegial, em 1986. Lancei vários softwares comerciais para a ‘plataforma’ Commodore (como <span class="caps">PET</span>, <span class="caps">VIC</span>-20, C-64/128) lá atrás. Em 1986 decidi que não havia futuro em computação (que mostra porque as pessoas não devem levar minhas opiniões muito a sério :)) e decidi estudar ciência física na universidade. Me graduei em 1995 com um doutorado em Química Orgânica e decidi que não havia futuro em química (que, se vocês olharem como a engenharia reversa da vida hoje é baseada em muita interação entre disciplinas com outros galhos de ciências da vida, mostra porque as pessoas não devem levar minhas opiniões muito a sério :))</p>
<p>Quando decidi trabalhar com computação novamente, eu peguei uma nova e obscura plataforma de desenvolvimento chamada Delphi que lançou a versão 1.0 na época que voltei a esse campo. Gastei bastante tempo trabalhando na integração de Delphi com <span class="caps">COM</span>, que é onde eu originalmente suspendi meu chapéu. O lado negro do <span class="caps">COM</span> me puxou à sua órbita e tenho trabalhado com coisas relacionadas à Microsoft desde então.</p>
<p><strong>AkitaOnRails:</strong> Vejo que está na Microsoft desde janeiro de 2007, é isso? Como entrou lá, você foi contratado por causa do projeto IronRuby? Essa é sua tarefa principal hoje?</p>
<p><strong>John Lam:</strong> Sim, comecei em janeiro. Antes de integrar a empresa, trabalhei em uma ponte open source entre Ruby e o <span class="caps">CLR</span> chamado “RubyCLR”. Quando decidi começar a promover esse trabalho nas conferências, cruzei meu caminho com a equipe do <span class="caps">DLR</span> da Microsoft. Mahesh Prakriya gentilmente doou metade do seu tempo na Tech Ed em 2006 para que eu pudesse falar sobre o RubyCLR. Depois de muita ansiedade e condicionamento mental acabei aceitando a oferta deles de trabalhar em tempo integral em uma implementação de Ruby sobre o <span class="caps">DLR</span> e nós (minha mulher, dois filhos e um cachorro) chegamos em Redmond em janeiro.</p>
<p style="text-align: center"><img src="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/166261351_2b04ab1086.jpg" srcset="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/166261351_2b04ab1086.jpg 2x" alt=""></p>
<p><strong>AkitaOnRails:</strong> Qual foi a motivação para começar IronRuby? Como ele iniciou? Você foi o único desenvolvedor original da implementação de Ruby sobre o .<span class="caps">NET</span>?</p>
<p><strong>John Lam:</strong> Queríamos demonstrar que o <span class="caps">DLR</span> é um verdadeiro runtime para múltiplas linguagens dinâmicas, então precisávamos construir várias linguagens sobre ela. Ruby certamente se encaixava nesse critério: dinâmica, forte comunidade de usuários, muita atenção, então fazia sentido implementá-la. IronRuby definitivamente forçou muitas decisões de mudanças no <span class="caps">DLR</span>, tornando-a menos “Pythônica” o que é uma coisa boa para outras pessoas interessadas em construir linguagens dinâmicas sobre nossa plataforma.</p>
<p>Definitivamente não sou o único desenvolvedor do IronRuby. Temos dois grandes desenvolvedores trabalhando no projeto: Tomas Matousek e John Messerly, e eles estão fazendo um trabalho incrível. Nossa pessoa de testes, Haibo Luo, está fazendo um grande trabalho para garantir que vamos lançar uma implementação de alta qualidade. O trabalho de Haibo será lançado junto com o IronRuby, o que significa que a comunidade vai se beneficiar desta suíte de testes.</p>
<p><strong>AkitaOnRails:</strong> Nem todos estão familiarizados com o <span class="caps">DLR</span> e Silverlight. Poderia descrever rapidamente para os iniciantes? O que torna o “<span class="caps">DLR</span>” diferente do “<span class="caps">CLR</span>” além de saltar da letra “C” para “D”? :-)</p>
<p><strong>John Lam:</strong> O <span class="caps">DLR</span> é uma plataforma que forma uma camada sobre o <span class="caps">CLR</span>. Isso significa que podemos rodar em qualquer lugar onde o <span class="caps">CLR</span> rodar, o que obviamente inclui Silverlight. Silverlight é nossa plataforma “multi-plataforma” baseada em browsers que roda em Windows, Mac e Linux (através do projeto Moonlight). Nós lançamos uma versão multi-plataforma do <span class="caps">CLR</span> o que significa que você será capaz de rodar linguagens baseadas em <span class="caps">DLR</span> com um download inicial de apenas 5Mb no seu browser web.</p>
<p><strong>AkitaOnRails:</strong> Isto é delicado: uma vez eu li Ola Bini e Charles Nutter criticando o “jeito Microsoft”, dizendo que seria extremamente difícil – se não impossível – para você escrever uma implementação 100% completa do Ruby 1.8 sobre o .<span class="caps">NET</span> sem poder olhar para seu código-fonte. A razão disso por causa da política da empresa em relação a licenças open source. Foi esse o caso?</p>
<p><strong>John Lam:</strong> Acho que o IronPython é a prova de existência que você pode construir uma implementação compatível de uma linguagem dinâmica sem olhar para o código-fonte original. Em nosso trabalho com IronRuby, posso lhe dizer que não poder olhar o código-fonte não nos impediu de entender como o Ruby atinge certas funcionalidades – tem tudo a ver com desenvolver os experimentos certos.</p>
<p><strong>AkitaOnRails:</strong> Também vi que IronRuby será lançado sob uma licença compatível com open source, da Microsoft, fazendo dela o primeiro projeto verdadeiramente open source da Microsoft. O que significa que vocês não apenas permitiriam as pessoas a dar uma olhada no código-fonte mas também de contribuir de volta. Quão longe estamos disso?</p>
<p><strong>John Lam:</strong> A Microsoft Public License foi oficialmente sancionada pelo <span class="caps">OSI</span> no começo de outubro. IronRuby, IronPython e o <span class="caps">DLR</span> estão todos sob essa licença.</p>
<p>Nós já aceitamos contribuições de volta da comunidade, e estamos continuando a aceitar mais contribuições.</p>
<p>Na realidade não somos o primeiro projeto Open Source na Microsoft a aceitar contribuições de volta da comunidade. Essa honra pertence ao <a href="https://www.asp.net/ajax/ajaxcontroltoolkit/samples/"><span class="caps">AJAX</span> control toolkit</a> do <span class="caps">ASP</span>.<span class="caps">NET</span> que é um projeto enormemente bem sucedido com mais de 1 milhão de downloads até hoje.</p>
<p style="text-align: center"><img src="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/166261286_d084c57e46.jpg" srcset="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/166261286_d084c57e46.jpg 2x" alt=""></p>
<p><strong>AkitaOnRails:</strong> O <span class="caps">DLR</span> foi originalmente concebido como um jeito experimental de rodar Python sobre .<span class="caps">NET</span>. Isso tornou mais fácil para uma implementação Ruby ou você acha que Python e Ruby são diferentes o suficiente para garantir muitos ajustes no <span class="caps">DLR</span> para torná-la possível?</p>
<p><strong>John Lam:</strong> É justo chamar a versão original do <span class="caps">DLR</span> como “Python Language Runtime”. Adicionar Ruby à mistura forçou várias mudanças adicionais ao <span class="caps">DLR</span>, a mais significante sendo a refatoração do runtime para migrar todos os idiomas específicos de Python (que pensaram ser genéricas mas acabou não sendo o caso) para o IronPython.dll. O que restou é um núcleo que nossas 4 linguagens desenvolvidas pela <span class="caps">MSFT</span> (IronRuby, IronPython, Managed JScript and VB) continuam a usar efetivamente hoje.</p>
<p><strong>AkitaOnRails:</strong> É um objetivo ser 100% compatível com o <span class="caps">MRI</span> 1.8? Ou vocês estão na direção de um sub-conjunto da implementação Ruby? Isso tornaria possível escrever programas .<span class="caps">NET</span> em Ruby, usando o conjunto completo de bibliotecas .<span class="caps">NET</span> e frameworks como <span class="caps">ASP</span>.<span class="caps">NET</span>, Windows.Forms, <span class="caps">LINQ</span>, etc. Ou estão planejando uma implementação totalmente compatível com o <span class="caps">MRI</span>, o suficiente para conseguir rodar uma aplicação inteira de Rails?</p>
<p><strong>John Lam:</strong> Nossa prioridade nr. 1 é ser tão compatível com o <span class="caps">MRI</span> 1.8.x quanto possível. A única funcionalidade que não vamos suportar é continuações, o que é consistente com JRuby. Além disso (e na falta de uma especificação de Ruby), a compatibilidade será julgada se podemos rodar aplicações reais de Ruby e suítes de teste desenvolvidos pela comunidade. Obviamente Rails é uma aplicação Ruby extremamente importante, que nós absolutamente vamos rodar sobre o IronRuby.</p>
<p>Interoperabilidae .<span class="caps">NET</span> é nossa prioridade nr. 2. Vamos integrar com a plataforma .<span class="caps">NET</span> e permitir escrever aplicações Ruby usando o rico conjunto de bibliotecas .<span class="caps">NET</span>. Obviamente coisas como Silverlight, <span class="caps">WPF</span>, <span class="caps">LINQ</span>, WinForms e <span class="caps">ASP</span>.<span class="caps">NET</span> serão suportadas.</p>
<p><strong>AkitaOnRails:</strong> Ruby cresceu como um esforço coletivo e discreto que realmente explodiu 3 anos atrás por causa de Rails. É uma das razões porque ninguém nunca se importou em escrever uma especificação formal e uma suíte de testes. Temos Alioth, a suíte de testes do <span class="caps">YARV</span>. Você teve dificuldades por causa da falta de uma especificação formal? Você está em contato com pessoas como Charles do JRuby, Koichi Sasada do <span class="caps">YARV</span> ou Evan Phoenix do Rubinius? O que acha de todos esses esforços acontecendo em paralelo? Há alguma maneira onde vocês possam contribuir entre vocês?</p>
<p><strong>John Lam:</strong> Estamos usando a suíte de especificações do Rubinius hoje, e planejamos lançá-lo junto com nossos fontes para garantir que iremos pegar bugs de compatibilidade cedo no processo. Sou culpado de não participar tanto quanto gostaria em falar mais com Charlie, Evan e Koichi sobre colaboração em especificações. Estamos focados em trazer o núcleo da linguagem rodando hoje, e temos vários outros projetos acelerados negligenciando documentar as coisas que temos aprendido. Quando desacelerarmos um pouco, serei capaz de gastar mais tempo me comunicando com os outros implementadores.</p>
<p><strong>AkitaOnRails:</strong> Ruby tem várias deficiências conhecidas. Koichi está tentando melhorar algumas delas para o Ruby 1.9. Como você está lidando com problemas como a falta de threading nativo, o garbage collector mark and sweep simples, nenhuma máquina virtual e portanto nenhuma compilação em byte-code, problemas de performance, falta de internacionalização nativa (Unicode), várias extensões escritas em C?</p>
<p><strong>John Lam:</strong> Nós ganhamos muitas coisas de ‘graça’ ao rodar sobre o <span class="caps">CLR</span>. Threading nativo é suportado em IronRuby. Nós usamos o garbage collector do <span class="caps">CLR</span>, que é um GC de classe mundial. Nós compilamos nativamente para IL, e nosso IL é compatível com o GC também o que é uma ótima coisa para aplicações de servidor que ficam de pé por um longo período. Nós obviamente suportaremos strings do <span class="caps">CLR</span>, que são strings Unicode e também suportaremos strings mutáveis do Ruby, que são baseadas em array de bytes. Não vamos suportar extensões baseadas em C, em vez disso estamos portando as bibliotecas baseadas em C, existentes no Ruby Standard Library para C# (ou Ruby).</p>
<p><strong>AkitaOnRails:</strong> Existe algum benchmark comparando IronRuby ao <span class="caps">MRI</span>? Vocês acham que já o ultrapassaram? Existe algum problema hoje sobre a performance do Ruby sobre o <span class="caps">DLR</span>? Ou mais interessante: existe alguma comparação entre Ruby no <span class="caps">DLR</span> e C# ou VB.<span class="caps">NET</span> sobre o <span class="caps">CLR</span>?</p>
<p><strong>John Lam:</strong> Somos mais rápidos que o <span class="caps">MRI</span> nos benchmarks do <span class="caps">YARV</span>, mas esse número muda diariamente. Uma coisa ótima sobre nossa equipe é que temos uma suíte de testes de regressão de performance que rodamos regularmente por todo nosso código. Isso torna trivial localizar uma compilação que causa uma regressão na performance, mesmo que deixemos para lidar com isso para mais tarde.</p>
<p>Não temos feito nenhuma otimização de performance até agora, estamos apenas usando funcionalidades que existem no <span class="caps">DLR</span> hoje, como caches inline polimórficos para caching eficiente de métodos call-site. À medida que nossa implementação amadurece, vamos otimizar IronRuby para performar bem em benchmarks de nível de aplicações (não micro-benchmarks, que são úteis para nós mas não tão interessantes para clientes reais). O <span class="caps">DLR</span> (e <span class="caps">CLR</span>) está se tornando mais rápido o tempo todo, e qualquer linguagem dinâmica construída sobre ele se beneficiará dessas melhorias.</p>
<p>Obviamente, linguagens como C# e VB.<span class="caps">NET</span> são mais rápidos que Ruby hoje. Mas estamos confiantes que podemos diminuir essa diferença significativamente com o tempo.</p>
<p><strong>AkitaOnRails:</strong> E sobre ferramental? Vi que você mexeu no seu Visual Studio.<span class="caps">NET</span> para ter o tema Vibrant Ink que nós – usuários de Textmate – estamos acostumados, e ficou legal. Vi também uma foto de tela de code folding do Ruby dentro do Visual Studio. Como está esse suporte para Ruby?</p>
<p><strong>John Lam:</strong> Neste momento nossa equipe não está envolvida com integração VS. Entretanto, o pessoal da <a href="https://www.sapphiresteel.com/IronRuby-Visual-Designer">Sapphire in Steel</a> está fazendo um grande trabalho integrando IronRuby ao VS.</p>
<p style="text-align: center"><a href="https://www.sapphiresteel.com/IronRuby-Visual-Designer"><img src="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/editing_small.gif" srcset="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/editing_small.gif 2x" alt=""></a></p>
<p><strong>AkitaOnRails:</strong> Você mencionou numa entrevista sobre a possibilidade de Ruby rodando sobre o Silverlight. Quão possível isso é hoje?</p>
<p><strong>John Lam:</strong> Demonstramos IronRuby rodando sobre o Silverlight na RubyConf. A conversa deve ser publicada logo. Estamos planejando em convergir com o Silverlight a tempo para seu próximo <span class="caps">CTP</span> (fim deste ano, começo do ano que vem). Nessa época, vocês serão capazes de codificar Ruby que roda no seu browser.</p>
<p><strong>AkitaOnRails:</strong> A Microsoft está aprendendo como lidar com as comunidades open source. Você acha que a adoção de tecnologias como Python e Ruby estão ajudando a empresa a entender o jeito open source? O que acha que ainda precisa melhorar? Quero dizer, se pudesse, o que você mudaria?</p>
<p><strong>John Lam:</strong> A Microsoft é uma empresa grande e estamos trabalhando com muito empenho em colaborar com a comunidade Open Source. IronRuby é um dos projetos open source mais visíveis da empresa, e estamos ajudando a pavimentar o caminho para outras equipes que querem se engajar com a comunidade open source. Mudanças acontecem incrementalmente em grandes empresas e tem sido legal fazer parte dessa mudança!</p>
<p><strong>AkitaOnRails:</strong> Silverlight foi lançado sobre uma licença open source também, de tal forma que o pessoal do <a href="https://www.mono-project.com/Main_Page">Mono</a> foi capaz de rodá-lo muito rapidamente sobre o Mono. Você é próximo a Miguel de Icaza? O que pensa sobre o Mono? Um IronRuby rodando sobre ele significa um Ruby multi-plataforma que pode rodar sobre o Linux (com .<span class="caps">NET</span>). Se você atingir 100% de compatibilidade com o <span class="caps">MRI</span> e Rails, isso significa rodar sobre um Apache+mod_mono no Linux e sobre o <span class="caps">IIS</span> no Windows, tudo desenvolvido sobre Orcas. Existe algum plano para esse tipo de integração e solução ponta-a-ponta?</p>
<p><strong>John Lam:</strong> Na realidade, o Silverlight não está sob uma licença Open Source. O <span class="caps">DLR</span>, IronPython e IronRuby estão todos sob a Microsoft Public License, o que torna possível para Michel e sua equipe lançá-lo sobre sua implementação <a href="https://www.mono-project.com/Moonlight">Moonlight</a> (que é a versão open source do Silverlight).</p>
<p>Eu adoro quão pragmático o Miguel é. Ele mostrou IronRuby rodando sobre o Mono na RubyConf e isso foi em grande parte por causa da equipe Mono consertar um monte de bugs de última hora para que pudéssemos fazer a demonstração (valeu!). <span class="caps">DLR</span> + Iron* tende a empurrar fortemente o C# e o <span class="caps">CLR</span>. Nós encontramos bugs no compilador C# da Microsoft, e também no gmcs do Mono. Mas felizmente, ambas as equipes de C# e Mono têm sido ótimos consertando esses bugs para nos desbloquear.</p>
<p style="text-align: center"><img src="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/481182714_62e1d07f7c.jpg" srcset="https://s3.amazonaws.com/akitaonrails/assets/2007/11/12/481182714_62e1d07f7c.jpg 2x" alt=""></p>
<p><strong>AkitaOnRails:</strong> Acho que é isso por hoje. Algum comentário para a audiência brasileira?</p>
<p><strong>John Lam:</strong> Muito obrigado por enviar um grande conjunto de perguntar! Boa sorte com suas aventuras Ruby e espero que tenham uma chance para checar IronRuby no futuro.</p>
<p></p>